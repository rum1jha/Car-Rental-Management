--------------------------------------------------------
--  File created - Tuesday-December-14-2021   
--------------------------------------------------------
--------------------------------------------------------
--  DDL for View SUPPORT_VIEW
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "ADMIN"."SUPPORT_VIEW" ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "EMAIL_ID", "CUSTOMER_TYPE", "SUPPORT_ID", "SUPPORT_STATUS", "CAR_ID", "CAR_MAKE", "MODEL", "CAR_TYPE", "RATE_PER_HR", "VIOLATION_DATE", "VIOLATION_DESC", "TRANS_ID", "TRANSACTION_DATE", "START_TIME", "END_TIME", "RIDE_DURATION", "DISTANCE", "TRANS_STATUS", "PAY_DATE", "PAYMENT_STATUS", "BILL_AMOUNT") DEFAULT COLLATION "USING_NLS_COMP"  AS 
  SELECT CUSTOMER_ID,
FIRST_NAME, 
LAST_NAME, 
EMAIL_ID, 
CUSTOMER_TYPE, 
SUPPORT_ID,
support_status,
car_id,
car_make, 
model, 
car_type, 
rate_per_hr, 
violation_date,
violation_desc,
TRANS_ID,
TRANSACTION_DATE, 
START_TIME, 
END_TIME, 
ride_duration, 
DISTANCE, 
trans_status, 
PAY_DATE, 
payment_status, 
bill_amount
FROM
(select sub.*, 
vio_rec.RECORD_DATE violation_date,
NVL(vio.description, 'NA') violation_desc 
FROM 
(SELECT
cust.CUSTOMER_ID,
cust.FIRST_NAME, 
cust.LAST_NAME, 
cust.EMAIL_ID, 
cust.CUSTOMER_TYPE, 
sup.SUPPORT_ID,
sup.STATUS support_status,
car.car_id,
car.car_make, 
car.model, 
car.car_type, 
car.rate_per_hr, 
rt.TRANS_ID,
rt.TRANSACTION_DATE, 
rt.START_TIME, 
rt.END_TIME, 
bill.ride_duration, 
rt.DISTANCE, 
rt.status as trans_status, 
pay.PAY_DATE, 
bill.status as payment_status, 
bill.bill_amount
FROM customers cust, 
ride_transaction rt, 
payments pay, 
car, 
payment_bill bill,
Support sup
WHERE cust.CUSTOMER_ID = rt.CUSTOMER_ID 
and rt.TRANS_ID = pay.TRANS_ID 
and rt.CAR_ID = car.CAR_ID 
and rt.TRANS_ID = bill.TRANS_ID
and rt.TRANS_ID = sup.TRANS_ID) sub, customers co
left join Violations_Records vio_rec on co.CUSTOMER_ID = vio_rec.CUSTOMER_ID
left join violations vio on vio_rec.violation_id = vio.violation_id
WHERE co.customer_id = sub.customer_id)
;
  GRANT DELETE ON "ADMIN"."SUPPORT_VIEW" TO "APP_OWNER";
  GRANT INSERT ON "ADMIN"."SUPPORT_VIEW" TO "APP_OWNER";
  GRANT SELECT ON "ADMIN"."SUPPORT_VIEW" TO "APP_OWNER";
  GRANT UPDATE ON "ADMIN"."SUPPORT_VIEW" TO "APP_OWNER";
  GRANT READ ON "ADMIN"."SUPPORT_VIEW" TO "APP_OWNER";
  GRANT ON COMMIT REFRESH ON "ADMIN"."SUPPORT_VIEW" TO "APP_OWNER";
  GRANT QUERY REWRITE ON "ADMIN"."SUPPORT_VIEW" TO "APP_OWNER";
  GRANT DEBUG ON "ADMIN"."SUPPORT_VIEW" TO "APP_OWNER";
  GRANT FLASHBACK ON "ADMIN"."SUPPORT_VIEW" TO "APP_OWNER";
  GRANT MERGE VIEW ON "ADMIN"."SUPPORT_VIEW" TO "APP_OWNER";
  GRANT DELETE ON "ADMIN"."SUPPORT_VIEW" TO "DEVELOPER";
  GRANT INSERT ON "ADMIN"."SUPPORT_VIEW" TO "DEVELOPER";
  GRANT SELECT ON "ADMIN"."SUPPORT_VIEW" TO "DEVELOPER";
  GRANT UPDATE ON "ADMIN"."SUPPORT_VIEW" TO "DEVELOPER";
  GRANT READ ON "ADMIN"."SUPPORT_VIEW" TO "DEVELOPER";
  GRANT ON COMMIT REFRESH ON "ADMIN"."SUPPORT_VIEW" TO "DEVELOPER";
  GRANT QUERY REWRITE ON "ADMIN"."SUPPORT_VIEW" TO "DEVELOPER";
  GRANT DEBUG ON "ADMIN"."SUPPORT_VIEW" TO "DEVELOPER";
  GRANT FLASHBACK ON "ADMIN"."SUPPORT_VIEW" TO "DEVELOPER";
  GRANT MERGE VIEW ON "ADMIN"."SUPPORT_VIEW" TO "DEVELOPER";
  GRANT DELETE ON "ADMIN"."SUPPORT_VIEW" TO "TESTER";
  GRANT INSERT ON "ADMIN"."SUPPORT_VIEW" TO "TESTER";
  GRANT SELECT ON "ADMIN"."SUPPORT_VIEW" TO "TESTER";
  GRANT UPDATE ON "ADMIN"."SUPPORT_VIEW" TO "TESTER";
  GRANT READ ON "ADMIN"."SUPPORT_VIEW" TO "TESTER";
  GRANT ON COMMIT REFRESH ON "ADMIN"."SUPPORT_VIEW" TO "TESTER";
  GRANT QUERY REWRITE ON "ADMIN"."SUPPORT_VIEW" TO "TESTER";
  GRANT DEBUG ON "ADMIN"."SUPPORT_VIEW" TO "TESTER";
  GRANT FLASHBACK ON "ADMIN"."SUPPORT_VIEW" TO "TESTER";
  GRANT MERGE VIEW ON "ADMIN"."SUPPORT_VIEW" TO "TESTER";
  GRANT SELECT ON "ADMIN"."SUPPORT_VIEW" TO "SERVICE";
